<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">

    <title>0</title>
    <style>
      
      
      body {
        color: #FEFEFE;
        background-color: #0c0d10;    
      }
  @font-face { font-family: "gohu"; src: url("gohu.woff") format('woff'); }
         pre { font-family: "gohu", "Lucida Console", monospace, Monaco; font-size: 15px; line-height: 1.5; }
           a { color: #93ffd7; text-decoration: none; }
           w { color: white;   }
           e { color: #93ffd7; } /* green  */
           k { color: #ff93f1; } /* pink   */
           l { color: #f1ff93; } /* yellow */
           o { color: #93f1ff; } /* blue   */
           r { color: #fa4d57; } /* red    */
  </style>
  </head>
  <body>
    <center>
<div style="display: inline-block; text-align: left;">
    <pre style="color: white;">




<a href="/index.html"><~[Home]</a>

         ／l、      MEOW!
        （ﾟ､ ｡ ７  /
          l、ﾞ~ヽ
          じしf_,)ノ
                  
lilith Struggling with heap senpai's binary

<img src="img/0/img1.png" alt="img1" style="height: 150px;">  img1

hmmm smol pp moment ! now we go open it in a disassembler

<img src="img/0/img2.png" alt="img2" style="height: 400px;">  img2

lets read the main function!
first it does its regular job of loading the stack and moving argc and argv to the registers 
then it checks weither the value of argc is == 2 as it takes one 1 argument vector shown in img1.
If it fails the condition then it jumps to the address 0x11bd. less have a look at it.

<img src="img/0/img3.png" alt="img3" style="height: 136px;">  img3

brrr....as we can see it just prints out the string "Umm...no..."
now lets see what happens if it matches the condition i.e if we pass something in the argument vector.

<img src="img/0/img4.png" alt="img4" style="height: 200px;">  img4

okkkkkkkk wait i am feeling cold... i am back. Back to the whatever we are doing. We can see that the string 
that we entered is being passed to a function call fun.00011dc. Now lets see what that function does to our 
baby stringwqnwdn. uhhghhghg my string ;-;-;-;!!

<img src="img/0/img5.png" alt="img5" style="height: 550px;">  img5

brrrr this shit is too confusing lets decompile it else ill die trying
you dont want me to die right?....right? do you want me to die do you want me to DIE???
ok

<img src="img/0/img6.png" alt="img6" style="height: 330px;">  img6

much better but we still need to do some cleanups...wait here
I just changed the variable names to something readable brrr wtf is uVar3 and var4h._4_4

<img src="img/0/img7.png" alt="img7" style="height: 410px;">  img7

before we do anything else lets first see what that 0x4050 holds for us. 
shshbh "FZGSVdzohWNAAGSCW^z_HMf]THbJWUnT_URK" som crazy string.
They are first comparing the length of that crazy string to the length of our baby string. 
And if the condition matches we enter inside the loop.

lets make it moe simple [note: asuming crazy = 0x4050]
<code>
13  j = crazy_string_len;
14  for(i = 0; i < crazy_string_len; i++){
15    if (crazy[i] ^ j ^ 55 ) != 
16      arg1[i]){ // this next line is on purpose cus i am trying to replicate the code line by line
17      return 0;
18    }
19    j--;
20  }
</code>
j stores the length of that crazy string. Then inside the for loop we have an if with some condition.
char at index i of crazy xor j xor 55 is != char at index i of our baby string.
waaaaaaw now we know whats actually happening inside the hood. We can just write a script to solve it

<img src="img/0/img8.png" alt="img8" style="height: 350px;">  img8

hmmm BIG pp moment !! we got the flag

<img src="https://c.tenor.com/sAvoFCX3GucAAAAj/kawaii-dancing.gif" alt="">
    </pre>
    </div>
    </center>

    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
  </body>
</html>
